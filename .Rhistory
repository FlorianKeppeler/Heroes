#                      variables = names(keys),
#                      group_index = list(1,2,c(3,4,5),3,c(4,5)),
#                      group_names = imp_names[["B102_edit"]][1:5])
#
#
# check_items_by_group(data = data,
#                      variables = "Krisenauf",
#                      group_index = list(1,2,c(3,4,5),3,c(4,5)),
#                      group_names = imp_names[["B102_edit"]][1:5])
# -> auf Skalenebene ists interessanter
skalen_scores = get_skalen_scores(data = data,
skalen = data_skalen_ohne,
skalen_names =  names(data_skalen_ohne))
# skalen ordnen -> wichtigste Haltekr채fte nach Umfragewert
plot_skalen_imp(create_skalen_imp(score_type = "scores_mean",
skalen_scores = skalen_scores,
group_index=get_index_by_group(data, group_index = c(1:5))),
mar=c(8,3,1,1))
#
# check_skalen(data=data,
#              skalen_scores=skalen_scores,
#              variables=names(skalen),
#              pred_var=pred_var,
#              score_type = "scores_mean",
#              group_names = imp_names)
#
# check_skalen(data=data,
#              skalen_scores=skalen_scores,
#              variables="Paed.Halt.2",
#              pred_var=pred_var,
#              score_type = "scores_mean",
#              group_names = imp_names)
# Faktorladungen pro Skala
check_loadings(skalen_scores)
# wichtigste Haltekraft nach Abgleich mit tats채chlicher Haltekraft f체r verschiedene Gruppierungen
group_list = list("Alle" = 1:5, "SBBZ" = 2, "Leitung" = 1, "HZE" = 3:5)
ums_data = create_ums_data(data, umsetzung)
plot_combined_imp(skalen, data, skalen_scores,
umsetzung, ums_data, group_list)
# Vergleiche der Skalen unter den Gruppen:
plot_group_diff(skalen, umsetzung, ums_data, group_list = list("SBBZ" = 2,"HZE" = 3:5))
plot_group_diff(skalen, umsetzung, ums_data, group_list = list("Leitung" = 1,"Mitarbeiter" = 2:5))
# Umsetzungsscores f체r RF generieren:
ums_scores = get_ums_scores(ums_data, skalen = data_skalen, names(data_skalen))
Halte_scores = get_skalen_scores(data = data,
skalen = data_skalen,
skalen_names = "Haltekraft")
ums_scores[["Haltekraft"]] = Halte_scores[["Haltekraft"]]
# Was ist mit der Transparenz.jM los?
hist(ums_scores[["Transparenz.jM"]]$scores_mean)
hist(skalen_scores[["Transparenz.jM"]]$scores_mean)
plot(ums_scores[["Haltekraft"]]$scores_mean ~ jitter(skalen_scores[["Transparenz.jM"]]$scores_mean),
ylab="Haltekraft", xlab ="Transparenz.jM")
plot(ums_scores[["Haltekraft"]]$scores_mean ~ jitter(ums_scores[["Transparenz.jM"]]$scores_mean),
ylab="Haltekraft", xlab ="Transparenz.jM")
# -> wahrscheinlich finden das eben alle wichtig und bereits gut umgesetzt
skalen_imp = create_skalen_imp(score_type = "scores_mean", skalen_scores = ums_scores, group_index = get_index_by_group(data, c(1:5)))
skalen_imp = skalen_imp[-1,]
plot_skalen_imp(skalen_imp,
mar=c(8,3,4,1),
ylim=c(0,1),
main="bereits umgesetzt")
# jap! Transparenz.jM ist die die Variable die bereits am meisten in den Einrichtungen umgesetzt wird.
ums_tmp = create_model_df(ums_scores = ums_scores, score_type = "scores_mean")
ums_df = ums_tmp[[1]]
ums_df_agg = ums_df
ums_df_agg$Einrichtung = data$B107
plot(density(ums_df_agg$Haltekraft))
plot(density(ums_df_agg$Haltekraft), ticks=TRUE )
points(ums_df_agg$Haltekraft, 0, pch="|")
points(ums_df_agg$Haltekraft, rep(0, nrow(ums_df_agg), pch="|")
points(ums_df_agg$Haltekraft, rep(0, nrow(ums_df_agg), pch="|"))
points(ums_df_agg$Haltekraft, rep(0, nrow(ums_df_agg), pch="|"))
plot(density(ums_df_agg$Haltekraft), ticks=TRUE )
points(ums_df_agg$Haltekraft, rep(0, nrow(ums_df_agg)), pch="|")
points(jitter(ums_df_agg$Haltekraft), rep(0, nrow(ums_df_agg)), pch="|")
ums_df_agg$Gruppe = data$B102
warnings()
ums_df_agg$Gruppe
points(jitter(ums_df_agg$Haltekraft), rep(0, nrow(ums_df_agg)),
pch="|", col=ifelse(1, "green", ifelse(2, "pink", "violet")))
plot(density(ums_df_agg$Haltekraft) )
points(jitter(ums_df_agg$Haltekraft), rep(0, nrow(ums_df_agg)),
pch="|", col=ifelse(ums_df_agg$Gruppe == 1, "green", ifelse(ums_df_agg$Gruppe == 2, "pink", "violet")))
plot(density(ums_df_agg$Haltekraft) )
points(jitter(ums_df_agg$Haltekraft), rep(0, nrow(ums_df_agg)),
pch="|", col=ifelse(ums_df_agg$Gruppe == 1, "green",
ifelse(ums_df_agg$Gruppe == 2, "pink", "orange")))
plot(density(ums_df_agg$Haltekraft))
points(jitter(ums_df_agg$Haltekraft), rep(0, nrow(ums_df_agg)),
pch="|", col=ifelse(ums_df_agg$Gruppe == 1, "#1b9e77",
ifelse(ums_df_agg$Gruppe == 2, "#e7298a", "#7570b3")))
points(jitter(ums_df_agg$Haltekraft, 2), rep(0, nrow(ums_df_agg)),
pch="|", col=ifelse(ums_df_agg$Gruppe == 1, "#1b9e77",
ifelse(ums_df_agg$Gruppe == 2, "#e7298a", "#7570b3")))
points(jitter(ums_df_agg$Haltekraft, 3), rep(0, nrow(ums_df_agg)),
pch="|", col=ifelse(ums_df_agg$Gruppe == 1, "#1b9e77",
ifelse(ums_df_agg$Gruppe == 2, "#e7298a", "#7570b3")))
plot(1:5, col=c("#1b9e77", "#e7298a","#7570b3","#66a61e", "#e6ab02"))
plot(1:5, col=c("#1b9e77", "#e7298a","#7570b3","#66a61e", "#e6ab02"), pch=20)
plot(density(ums_df_agg$Haltekraft))
points(jitter(ums_df_agg$Haltekraft, 3), rep(0, nrow(ums_df_agg)),
pch="|", col=ifelse(ums_df_agg$Gruppe == 1, "#1b9e77",
ifelse(ums_df_agg$Gruppe == 2, "#e6ab02", "#7570b3")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#7570b3"), legend = c("Leitung","SBBZ","HZE"))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#7570b3"),
legend = c("Leitung","SBBZ","HZE"), bty=n)
points(jitter(ums_df_agg$Haltekraft, 3), rep(0, nrow(ums_df_agg)),
pch="|", col=ifelse(ums_df_agg$Gruppe == 1, "#1b9e77",
ifelse(ums_df_agg$Gruppe == 2, "#e6ab02", "#7570b3")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#7570b3"),
legend = c("Leitung","SBBZ","HZE"), bty=n)
lines(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", 1), ])),col="#1b9e77")
plot(density(ums_df_agg$Haltekraft))
lines(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", 1), ])),col="#1b9e77")
lines(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", 1)])),col="#1b9e77")
lines(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", 2)])),
col="#e6ab02")
lines(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", c(3:5))])),
col="#7570b3")
plot(density(ums_df_agg$Haltekraft))
lines(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", 1)])),
col="#1b9e77")
lines(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", 2)])),
col="#e6ab02")
lines(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", c(3:5))])),
col="#e7298a")
points(jitter(ums_df_agg$Haltekraft, 3), rep(0, nrow(ums_df_agg)),
pch="|", col=ifelse(ums_df_agg$Gruppe == 1, "#1b9e77",
ifelse(ums_df_agg$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty=n)
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
plot(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", 1)])),
col="#1b9e77")
lines(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", 2)])),
col="#e6ab02")
lines(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", c(3:5))])),
col="#e7298a")
points(jitter(ums_df_agg$Haltekraft, 3), rep(0, nrow(ums_df_agg)),
pch="|", col=ifelse(ums_df_agg$Gruppe == 1, "#1b9e77",
ifelse(ums_df_agg$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
imp_names[["B107"]]
data$B107
imp_names[["B107"]]
i = 2
plot(density((ums_df_agg$Haltekraft[get_index_by_group(data, "B102", 1)])),
col="#1b9e77", main=imp_names[["B107"]][i])
for(i in unique(ums_df_agg$Einrichtung)){
print(i)
}
ums_df_agg[get_index_by_group(data, "B107", i)]), ]
ums_df_agg[get_index_by_group(data, "B107", i), ]
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
for(i in unique(ums_df_agg$Einrichtung)){
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
plot(density((data_slice$Haltekraft[get_index_by_group(data, "B102", 1)])),
col="#1b9e77", main=imp_names[["B107"]][i])
lines(density((data_slice$Haltekraft[get_index_by_group(data, "B102", 2)])),
col="#e6ab02")
lines(density((data_slice$Haltekraft[get_index_by_group(data, "B102", c(3:5))])),
col="#e7298a")
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
}
i
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
data_slice
unique(ums_df_agg$Einrichtung)
data_slice
plot(density((data_slice$Haltekraft[get_index_by_group(data, "B102", 1)])),
col="#1b9e77", main=imp_names[["B107"]][i])
data_slice$Haltekraft[get_index_by_group(data, "B102", 1)])
data_slice$Haltekraft[get_index_by_group(data, "B102", 1)]
get_index_by_group(data_slice, "B102", 1)
get_index_by_group(data_slice, "Gruppe", 1)
for(i in unique(ums_df_agg$Einrichtung)){
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77", main=imp_names[["B107"]][i])
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02")
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a")
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
}
for(i in unique(ums_df_agg$Einrichtung)){
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 1))
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02")
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a")
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
}
for(i in unique(ums_df_agg$Einrichtung)){
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 1))
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02")
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a")
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
}
for(i in unique(ums_df_agg$Einrichtung)){
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 1))
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02")
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77")
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
}
for(i in unique(ums_df_agg$Einrichtung)){
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 1))
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02")
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77")
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
}
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 1))
i
data_slice
imp_names[["B107"]][i]
i
for(i in unique(ums_df_agg$Einrichtung)){
if(i == 11) next
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 1))
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02")
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77")
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
}
i
data_slice
for(i in unique(ums_df_agg$Einrichtung)){
if(i == 11 | i == 40) next
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 1))
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02")
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77")
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
}
data_slice = ums_df_agg
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 1))
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02")
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77")
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 0.8))
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02")
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77")
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
data_slice = ums_df_agg
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 0.8), lwd=2)
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02", lwd=2)
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77", lwd=2)
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
data_slice = ums_df_agg
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main="Alle Einrichtungen",
xlim=c(1, 6),
ylim=c(0, 0.8), lwd=2)
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02", lwd=2)
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77", lwd=2)
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main="Alle Einrichtungen",
xlim=c(1, 6),
ylim=c(0, 0.7), lwd=2)
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02", lwd=2)
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77", lwd=2)
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
nrow(data_slice)
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main="Alle Einrichtungen",
xlim=c(1, 6),
ylim=c(0, 0.7), lwd=2, xlab="")
data_slice = ums_df_agg
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main="Alle Einrichtungen",
xlim=c(1, 6),
ylim=c(0, 0.7), lwd=2, xlab="Haltekraft")
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02", lwd=2)
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77", lwd=2)
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
for(i in unique(ums_df_agg$Einrichtung)){
if(i == 11 | i == 40) next
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 1), lwd=2, xlab="Haltekraft")
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02", lwd=2)
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77", lwd=2)
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")))
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")),
cex=2)
for(i in unique(ums_df_agg$Einrichtung)){
if(i == 11 | i == 40) next
data_slice = ums_df_agg[get_index_by_group(data, "B107", i), ]
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main=imp_names[["B107"]][i],
xlim=c(1, 6),
ylim=c(0, 1), lwd=2, xlab="Haltekraft")
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02", lwd=2)
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77", lwd=2)
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")),
cex=2)
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
}
data_slice = ums_df_agg
plot(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", c(3:5))])),
col="#e7298a",
main="Alle Einrichtungen",
xlim=c(1, 6),
ylim=c(0, 0.7), lwd=2, xlab="Haltekraft")
if(length(get_index_by_group(data_slice, "Gruppe", 2)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 2)])),
col="#e6ab02", lwd=2)
}
if(length(get_index_by_group(data_slice, "Gruppe", 1)) > 2){
lines(density((data_slice$Haltekraft[get_index_by_group(data_slice, "Gruppe", 1)])),
col="#1b9e77", lwd=2)
}
points(jitter(data_slice$Haltekraft, 3), rep(0, nrow(data_slice)),
pch="|", col=ifelse(data_slice$Gruppe == 1, "#1b9e77",
ifelse(data_slice$Gruppe == 2, "#e6ab02", "#e7298a")),
cex=2)
legend("topleft", fill = c("#1b9e77", "#e6ab02", "#e7298a"),
legend = c("Leitung","SBBZ","HZE"), bty="n")
